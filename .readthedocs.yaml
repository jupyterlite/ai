# Read the Docs configuration file
# See https://docs.readthedocs.io/en/stable/config-file/v2.html for details

version: 2

build:
  os: ubuntu-24.04

  tools:
    python: "3.12"
    nodejs: "22"

  commands:
    # BUILD jupyterlite
    - pip install uv
    - cd ./demo
    - uv python install
    - uv sync --locked --all-extras --dev
    - mkdir contents & cp README.md contents
    - uv run jupyter lite build

    # BUILD docs
    - pip install jupyter-book
    - npm run docs:build

    # COPY docs asset to output html
    - mkdir -p $READTHEDOCS_OUTPUT/html/
    - cp -r _build/html/* $READTHEDOCS_OUTPUT/html/
    - rm -rf _build

    # COPY jupyterlite assets to output html
    - mv ./demo/dist $READTHEDOCS_OUTPUT/html/lite
